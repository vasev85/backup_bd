# Домашнее задание к занятию 12.8 "Резервное копирование баз данных"

Домашнее задание выполните в Google Docs и отправьте в личном кабинете на проверку ссылку на ваш документ.

Название файла должно содержать номер лекции и фамилию студента. Пример названия: "12.8 Резервное копирование баз данных - Александр Александров"

Перед тем как выслать ссылку, убедитесь, что ее содержимое не является приватным (открыто на просмотр всем, у кого есть ссылка). Если необходимо прикрепить дополнительные ссылки, просто добавьте их в свой Google Docs.

Любые вопросы по решению задач задавайте в чате учебной группы.

---

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надежность работы БД и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1 Необходимо восстанавливать данные в полном объеме за предыдущий день. Делать полную копию по заданию раз в день

1.2 Необходимо восстанавливать данные за час до предполагаемой поломки. Делать инкрементную копию от полной каждый час

1.3* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую/починеную БД? Путем размещения БД в облачном сервисе. Облачная база данных или DBaaS (Database as a Service).

*Приведите ответ в свободной форме.*

---

### Задание 2. PostgreSQL

2.1 С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

pg_dump -Uvase -Fc vase > vase.dump
 dropdb -Uvase vase
pg_restore -Uvase -C -d postgres  vase.dump

2.1* Возможно ли автоматизировать этот процесс? Если да, то как? 
Через скрипт автоматизировать создания резервных  копий, добавить в планировщик заданий.  При срабатывании тригера на метрику в системе мониторинга запускать скрипт на восстановление. При этом переходить на реплику. Затем догнать восстановленую БД с реплики.


*Приведите ответ в свободной форме.*

---

### Задание 3. MySql

3.1 С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySql. 
Инкрементное резервное копирование с помощью утилиты Persona XtraBackup.

сначала создаем полный бэкап,затем от него инкрементный. Возможно делать инкрементный от инкрементного но это не надежно.
xtrabackup  --backup  --target-dir=/home/backup2/ --datadir=/var/lib/mysql/

xtrabackup --backup --incremental-basedir=/home/backup2 --target-dir=/home/incr1 --datadir=/var/lib/mysql/

3.1* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием? В том случае если в бэкапе на момент времени далеко не актуальная информация, т.е. бэкап делался давно. То актуальнее будут данные которые в реплике. Но часть данных возможно потерять, они не в полном объеме обновились в слайве или мастер-мастер не полностью обновились. Переход с мастера на слейв будет почти не заметен, чем восстановление из бэкапа.  Восcтановление из бэкапа требует больше тестов, при создании скрипта автоматизации. Но  этот вопрос не отменяет бэкап, его все равно надо делать и проверять, когда-нибудь он понадобится!

*Приведите ответ в свободной форме.*

---

Задания,помеченные звездочкой * - дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.
